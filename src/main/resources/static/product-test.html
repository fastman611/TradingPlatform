<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>åŒåŸå¿«å§ - å•†å“æ¨¡å—æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section {
            background: #f5f5f5;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        h2 { color: #333; }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 3px;
            cursor: pointer;
        }
        button:hover { background: #45a049; }
        .result {
            background: #333;
            color: #fff;
            padding: 10px;
            margin-top: 10px;
            border-radius: 3px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .test-case { margin: 10px 0; }
    </style>
</head>
<body>
<h1>ğŸª åŒåŸå¿«å§ - å•†å“æ¨¡å—æµ‹è¯•</h1>

<div class="section">
    <h2>1. ğŸ“ ç”¨æˆ·æ³¨å†Œï¼ˆå…ˆæ³¨å†Œä¸€ä¸ªå–å®¶ï¼‰</h2>
    <div class="test-case">
        <button onclick="registerSeller()">æ³¨å†Œå–å®¶ç”¨æˆ·</button>
    </div>
</div>

<div class="section">
    <h2>2. ğŸ“¦ å•†å“å‘å¸ƒæµ‹è¯•</h2>
    <div class="test-case">
        <button onclick="publishProduct1()">å‘å¸ƒå•†å“1ï¼šäºŒæ‰‹æ‰‹æœº</button>
        <button onclick="publishProduct2()">å‘å¸ƒå•†å“2ï¼šç¬”è®°æœ¬ç”µè„‘</button>
        <button onclick="publishProduct3()">å‘å¸ƒå•†å“3ï¼šå®¶å…·</button>
    </div>
</div>

<div class="section">
    <h2>3. ğŸ” å•†å“æŸ¥è¯¢æµ‹è¯•</h2>
    <div class="test-case">
        <button onclick="getAllProducts()">è·å–æ‰€æœ‰å•†å“</button>
        <button onclick="searchProducts('æ‰‹æœº')">æœç´¢"æ‰‹æœº"</button>
        <button onclick="getProductDetail(1)">æŸ¥çœ‹å•†å“1è¯¦æƒ…</button>
    </div>
</div>

<div class="section">
    <h2>4. ğŸ“Š å•†å“ç®¡ç†æµ‹è¯•</h2>
    <div class="test-case">
        <button onclick="getProductsBySeller(currentSellerId)">æŸ¥çœ‹å½“å‰å–å®¶çš„å•†å“</button>
        <button onclick="deactivateProduct(1)">ä¸‹æ¶å•†å“1</button>
        <button onclick="markAsSold(2)">æ ‡è®°å•†å“2ä¸ºå·²å”®å‡º</button>
    </div>
</div>

<h2>ğŸ“‹ æµ‹è¯•ç»“æœï¼š</h2>
<div class="result" id="result">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>

<script>
    let currentSellerId = 1; // é»˜è®¤å–å®¶ID

    function showResult(message) {
        document.getElementById('result').innerHTML =
            typeof message === 'string' ? message : JSON.stringify(message, null, 2);
    }

    // 1. æ³¨å†Œå–å®¶
    function registerSeller() {
        fetch('/api/user/register', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                username: 'seller001',
                password: '123456',
                nickname: 'æµ‹è¯•å–å®¶',
                phone: '13900139001',
                email: 'seller@kb.com',
                role: 'SELLER'
            })
        })
            .then(r => r.json())
            .then(data => {
                currentSellerId = data.id;
                showResult('å–å®¶æ³¨å†ŒæˆåŠŸï¼ID: ' + currentSellerId + '\n' + JSON.stringify(data, null, 2));
            })
            .catch(err => showResult('æ³¨å†Œå¤±è´¥: ' + err));
    }

    // 2. å‘å¸ƒå•†å“ - ä¿®æ”¹è¿™ä¸‰ä¸ªå‡½æ•°
    function publishProduct1() {
        fetch('/api/product/publish', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                title: 'äºŒæ‰‹iPhone 13 Pro æ‰‹æœº',
                description: '99æ–°ï¼Œ256Gï¼Œä½¿ç”¨ä¸€å¹´ï¼Œæ— æ‹†æ— ä¿®ï¼ŒåŠŸèƒ½å®Œå¥½',
                price: 4500.00,
                originalPrice: 5500.00,
                category: 'ç”µå­äº§å“',  // æ”¹ä¸ºä¸­æ–‡åˆ†ç±»
                location: 'åŒ—äº¬å¸‚æµ·æ·€åŒº',
                sellerId: 3,          // æ”¹ä¸ºç”¨æˆ·ID 3ï¼ˆseller001ï¼‰
                sellerName: 'æµ‹è¯•å–å®¶',
                contactPhone: '13900139001',
                stock: 1
                // æ³¨æ„ï¼šä¸è¦ä¼ statusï¼ŒServiceä¼šè‡ªåŠ¨è®¾ç½®ä¸º1
            })
        })
            .then(r => {
                if (!r.ok) {
                    return r.text().then(text => { throw new Error(text) });
                }
                return r.json();
            })
            .then(data => {
                showResult('âœ… å•†å“å‘å¸ƒæˆåŠŸï¼å•†å“IDï¼š' + data.id +
                    '\n' + JSON.stringify(data, null, 2));
            })
            .catch(err => showResult('âŒ å‘å¸ƒå¤±è´¥: ' + err.message));
    }

    function publishProduct2() {
        fetch('/api/product/publish', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                title: 'åä¸ºMateBookç¬”è®°æœ¬ç”µè„‘',
                description: 'i7å¤„ç†å™¨ï¼Œ16Gå†…å­˜ï¼Œ512G SSDï¼Œè½»è–„ä¾¿æº',
                price: 3200.00,
                originalPrice: 4200.00,
                category: 'ç”µå­äº§å“',  // æ”¹ä¸ºä¸­æ–‡
                location: 'ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº',
                sellerId: 3,          // ç”¨æˆ·ID 3
                sellerName: 'æµ‹è¯•å–å®¶',
                contactPhone: '13900139001',
                stock: 1
            })
        })
            .then(r => r.json())
            .then(data => showResult('å•†å“å‘å¸ƒæˆåŠŸï¼\n' + JSON.stringify(data, null, 2)))
            .catch(err => showResult('å‘å¸ƒå¤±è´¥: ' + err));
    }

    function publishProduct3() {
        fetch('/api/product/publish', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                title: 'å®æœ¨ä¹¦æ¡Œå®¶å…·',
                description: '1.2ç±³é•¿ï¼Œå®æœ¨æè´¨ï¼Œä¹æˆæ–°',
                price: 800.00,
                category: 'å®¶å…·å®¶å±…',  // æ”¹ä¸ºä¸­æ–‡
                location: 'å¹¿å·å¸‚å¤©æ²³åŒº',
                sellerId: 3,          // ç”¨æˆ·ID 3
                sellerName: 'æµ‹è¯•å–å®¶',
                contactPhone: '13900139001',
                stock: 1
            })
        })
            .then(r => r.json())
            .then(data => showResult('å•†å“å‘å¸ƒæˆåŠŸï¼\n' + JSON.stringify(data, null, 2)))
            .catch(err => showResult('å‘å¸ƒå¤±è´¥: ' + err));
    }

    // 3. æŸ¥è¯¢å•†å“
    function getAllProducts() {
        fetch('/api/product/list?page=0&size=10')
            .then(r => r.json())
            .then(data => showResult('å•†å“åˆ—è¡¨ï¼š\n' + JSON.stringify(data, null, 2)))
            .catch(err => showResult('æŸ¥è¯¢å¤±è´¥: ' + err));
    }

    function searchProducts(keyword) {
        fetch('/api/product/search?keyword=' + encodeURIComponent(keyword))
            .then(r => r.json())
            .then(data => showResult('æœç´¢ç»“æœï¼š\n' + JSON.stringify(data, null, 2)))
            .catch(err => showResult('æœç´¢å¤±è´¥: ' + err));
    }

    function getProductDetail(id) {
        fetch('/api/product/' + id)
            .then(r => r.json())
            .then(data => showResult('å•†å“è¯¦æƒ…ï¼š\n' + JSON.stringify(data, null, 2)))
            .catch(err => showResult('æŸ¥è¯¢å¤±è´¥: ' + err));
    }

    // 4. å•†å“ç®¡ç†
    function getProductsBySeller(sellerId) {
        fetch('/api/product/seller/' + sellerId)
            .then(r => r.json())
            .then(data => showResult('å–å®¶å•†å“ï¼š\n' + JSON.stringify(data, null, 2)))
            .catch(err => showResult('æŸ¥è¯¢å¤±è´¥: ' + err));
    }

    function deactivateProduct(productId) {
        fetch('/api/product/deactivate/' + productId + '?sellerId=' + currentSellerId, {
            method: 'PUT'
        })
            .then(r => r.json())
            .then(data => showResult('ä¸‹æ¶æˆåŠŸï¼š\n' + JSON.stringify(data, null, 2)))
            .catch(err => showResult('æ“ä½œå¤±è´¥: ' + err));
    }

    function markAsSold(productId) {
        fetch('/api/product/sold/' + productId + '?sellerId=' + currentSellerId, {
            method: 'PUT'
        })
            .then(r => r.json())
            .then(data => showResult('æ ‡è®°ä¸ºå·²å”®å‡ºï¼š\n' + JSON.stringify(data, null, 2)))
            .catch(err => showResult('æ“ä½œå¤±è´¥: ' + err));
    }
</script>
</body>
</html>